s_points = 5;
loop_iter = 3;
start_iter = 20;
max_area = 0;
max_circles = 0;

for circles = 47:100
    xopt = zeros(1, 2 * circles + 1);
    %x = starting_points_3(circles, s_points);  
    %x = [0.5640 ,  0.0889   , 0.1050 ,   0.4698   , 0.2232 ,   0.2085  ,  0.7376 ,   0.9573  ,  0.9544  ,  0.0369   , 0.8737  ,  0.3420  ,  0.4764,    0.8818  ,  0.9304,    0.2224 ,   0.3911  ,  0.9429 ,   0.3430 ,   0.9607  ,  0.2807 ,   0.0699  ,  0.2234, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 0.2, 0.3, 0.8, 0.9, 0.2,  0.5, 0.6, 0.7, 0.8, 0.9, 0.2, 0.3, 0.8, 0.9, 0.2,0.3, 0.4, 0.5, 0.7447  ,  0.7283 ,   0.1050,    0.0388,    0.1621,    0.7332,    0.5198,    0.2855,    0.1822,    0.2295,    0.7220 ,   0.1054,    0.4654 ,   0.5487,    0.0696 ,   0.4107,    0.2278 ,   0.3844 ,   0.9470 ,   0.6850 ,   0.8703 ,   0.6500 ,   0.0333 , 0.3, 0.5, 0.6, 0.7, 0.8, 0.9, 0.2, 0.3, 0.8, 0.9, 0.2, 0.2, 0.8, 0.6, 0.5, 0.5, 0.8, 0.6, 0.5, 0.5, 0.5, 0.7, 0.8, 0.9, 0.9, 0.2, 0.1, 0.2553  ,  0.0193 ,   0.1050  ,  0.0388 ,   0.0262  ,  0.1004,   0.0289  ,  0.0427  ,  0.0456  ,  0.0369  ,  0.0553  ,  0.1054  ,  0.0374  ,  0.1182   , 0.0696  ,  0.2224   , 0.0264  ,  0.0571   , 0.0443,    0.0393   , 0.0545   , 0.0613   , 0.0333, 0.01 , 0.01 , 0.01, 0.001, 0.01, 0.001, 0.01, 0.001,0.01, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.023, 0.001,0.01, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.023]


    x = [0.5575, 0.0817, 0.103, 0.4707, 0.223, 0.2016, 0.7347, 0.958, 0.9544, 0.0143, 0.8676, 0.3444, 0.4737, 0.8803, 0.9304, 0.2214, 0.3916, 0.9425, 0.3566, 0.9583, 0.272, 0.0627, 0.2234, 0.0364, 0.2603, 0.2951, 0.3003, 0.3328, 0.7242, 0.8393, 0.9237, 0.8916, 0.2116, 0.2557, 0.908, 0.8882, 0.1401, 0.4376, 0.5252, 0.8298, 0.8201, 0.8751, 0.2707, 0.3227, 0.8417, 0.886, 0.2031, 0.744, 0.7207, 0.103, 0.0384, 0.1555, 0.7263, 0.5207, 0.2698, 0.1822, 0.1798, 0.7257, 0.1039, 0.4629, 0.5518, 0.0696, 0.405, 0.2251, 0.3859, 0.9606, 0.6931, 0.8631, 0.6407, 0.0352, 0.2254, 0.633, 0.6412, 0.6767, 0.9053, 0.9729, 0.0298, 0.3156, 0.7747, 0.8681, 0.1758, 0.148, 0.7763, 0.6278, 0.501, 0.4746, 0.7902, 0.6734, 0.4158, 0.6246, 0.6153, 0.6711, 0.7773, 0.8445, 0.256, 0.0196, 0.103, 0.0384, 0.0281, 0.1004, 0.0291, 0.042, 0.0456, 0.0143, 0.0546, 0.1039, 0.0374, 0.1197, 0.0696, 0.2214, 0.0262, 0.0575, 0.0394, 0.0417, 0.0534, 0.0627, 0.0352, 0.0364, 0.0098, 0.026, 0.01, 0.0207, 0.0271, 0.0298, 0.0153, -0.0, 0.0072, 0.0104, 0.012, 0.0001, 0.0157, 0.0151, 0.0154, 0.0202, 0.016, 0.0163, 0.0036, 0.0119, 0.0057, 0.0002, 0.0179]







    [a, x] = discs_3(circles, x);

    if a > max_area
        max_area = a
        xopt = x
        plot_3(circles, xopt);
        max_circles = circles
    end

    for i = 1:start_iter  
        for j = 1:loop_iter
            [a, x] = disk_3_global(circles, x);
        
            if a > max_area
                max_area = a
                xopt = x
                plot_3(circles, xopt);
                max_circles = circles
            end
        end
        
        smallest_r = inf;
        smallest_r_i = 0;
        for r = 1:circles
            if xopt(2*circles + r) < smallest_r
                smallest_r_i = r;
                smallest_r = xopt(2*circles + r);
            end
        end

        for rep = 1:1000
            new_x = rand();
            new_y = rand();
        
            bool = 1;
            for c = 1:circles
                if (xopt(c) - new_x)^2 + (xopt(circles + c) - new_y)^2 < xopt(2*circles + c)^2
                    bool = 0;
                end
            end
        
            if bool == 1
                break;
            end
        end

        xopt(smallest_r_i) = new_x;
        xopt(circles + smallest_r_i) = new_y;
    end
end

  

